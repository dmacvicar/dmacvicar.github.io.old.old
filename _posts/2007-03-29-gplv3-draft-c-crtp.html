---
layout: post
title: GPLv3 draft. C++ CRTP
date: 2007-03-29 20:47:56.000000000 +02:00
type: post
published: true
status: publish
categories: []
tags:
- open-source
- patents
- software
meta:
  posterous_6c96d52da40a5d7e34be538822acc826_post_id: '48643998'
  posterous_6c96d52da40a5d7e34be538822acc826_permalink: http://duncan.mac-vicar.com/gplv3-draft-c-crtp
  _oembed_3f8972e0e56b0db5ddb5a88f773d82eb: "{{unknown}}"
  _oembed_52d1f4e6a6e77727ead84f1fcdfbc1f8: "{{unknown}}"
  _oembed_5e2654af317b681e868078a7167b17f3: "{{unknown}}"
  _oembed_fd783275939f5d7502e598e9775492b9: "{{unknown}}"
  _oembed_6c54cd41ca2e7d9ca1f81b273db49ff6: "{{unknown}}"
author:
  login: duncan
  email: dmacvicar@gmail.com
  display_name: duncan
  first_name: Duncan
  last_name: Mac-Vicar P.
---
<p>
    A new discussion draft of the GNU GPL has been released. [Go here to see more][1]. Note the end of the Patents section in the changes guide:</p>
<p>&gt;specifically granted to recipients of the covered work under this License[, unless you entered into that arrangement, or that patent license was granted, prior to March 28, 2007].</p>
<p>I heard for first time about the [Curiously Recurring Template Pattern][3] when I read the [Eigen library][2] webpage. Now I found [this example][4] by Bruce Eckel that makes it much clearer:</p>
<p><span style="color:#00b;"></span><span style="color:#800080;">//: generics/Mixins.cpp<br />
<br />#include<br />
<br />#include<br />
<br />#include<br />
<br /></span><span style="color:#00b;">using namespace std</span><span style="color:#070;">;</p>
<p></span><span style="color:#00b;">template</span><span style="color:#070;">&lt;class </span><span style="color:#00b;">T</span><span style="color:#070;">&gt; class </span><span style="color:#00b;">TimeStamped </span><span style="color:#070;">: </span><span style="color:#00b;">public T </span><span style="color:#070;">{<br />
<br />&nbsp;&nbsp;</span><span style="color:#00b;">long timeStamp</span><span style="color:#070;">;<br />
<br /></span><span style="color:#00b;">public</span><span style="color:#070;">:<br />
<br />&nbsp;&nbsp;</span><span style="color:#00b;">TimeStamped</span><span style="color:#070;">() { </span><span style="color:#00b;">timeStamp </span><span style="color:#070;">= </span><span style="color:#00b;">time</span><span style="color:#070;">(</span><span style="color:#00b;">0</span><span style="color:#070;">); }<br />
<br />&nbsp;&nbsp;</span><span style="color:#00b;">long getStamp</span><span style="color:#070;">() { return </span><span style="color:#00b;">timeStamp</span><span style="color:#070;">; }<br />
<br />};</p>
<p></span><span style="color:#00b;">template</span><span style="color:#070;">&lt;class </span><span style="color:#00b;">T</span><span style="color:#070;">&gt; class </span><span style="color:#00b;">SerialNumbered </span><span style="color:#070;">: </span><span style="color:#00b;">public T </span><span style="color:#070;">{<br />
<br />&nbsp;&nbsp;</span><span style="color:#00b;">long serialNumber</span><span style="color:#070;">;<br />
<br />&nbsp;&nbsp;static </span><span style="color:#00b;">long counter</span><span style="color:#070;">;<br />
<br /></span><span style="color:#00b;">public</span><span style="color:#070;">:<br />
<br />&nbsp;&nbsp;</span><span style="color:#00b;">SerialNumbered</span><span style="color:#070;">() { </span><span style="color:#00b;">serialNumber </span><span style="color:#070;">= </span><span style="color:#00b;">counter</span><span style="color:#070;">++; }<br />
<br />&nbsp;&nbsp;</span><span style="color:#00b;">long getSerialNumber</span><span style="color:#070;">() { return </span><span style="color:#00b;">serialNumber</span><span style="color:#070;">; }<br />
<br />};</p>
<p></span><span style="color:#800080;">// Define and initialize the static storage:<br />
<br /></span><span style="color:#00b;">template</span><span style="color:#070;">&lt;class </span><span style="color:#00b;">T</span><span style="color:#070;">&gt; </span><span style="color:#00b;">long SerialNumbered</span><span style="color:#070;">&lt;</span><span style="color:#00b;">T</span><span style="color:#070;">&gt;::</span><span style="color:#00b;">counter </span><span style="color:#070;">= </span><span style="color:#00b;">1</span><span style="color:#070;">;</p>
<p></span><span style="color:#00b;">int main</span><span style="color:#070;">() {<br />
<br />&nbsp;&nbsp;</span><span style="color:#00b;">TimeStamped</span><span style="color:#070;">&lt;</span><span style="color:#00b;">SerialNumbered</span><span style="color:#070;">&lt;</span><span style="color:#00b;">string</span><span style="color:#070;">&gt; &gt; </span><span style="color:#00b;">mixin1</span><span style="color:#070;">, </span><span style="color:#00b;">mixin2</span><span style="color:#070;">;<br />
<br />&nbsp;&nbsp;</span><span style="color:#00b;">mixin1</span><span style="color:#070;">.</span><span style="color:#00b;">append</span><span style="color:#070;">(</span><span style="color:#d00;">"test string 1"</span><span style="color:#070;">); </span><span style="color:#800080;">// A string method<br />
<br />&nbsp;&nbsp;</span><span style="color:#00b;">mixin2</span><span style="color:#070;">.</span><span style="color:#00b;">append</span><span style="color:#070;">(</span><span style="color:#d00;">"test string 2"</span><span style="color:#070;">);<br />
<br />&nbsp;&nbsp;</span><span style="color:#00b;">cout </span><span style="color:#070;">&lt;&lt; </span><span style="color:#00b;">mixin1 </span><span style="color:#070;">&lt;&lt; </span><span style="color:#d00;">" " </span><span style="color:#070;">&lt;&lt; </span><span style="color:#00b;">mixin1</span><span style="color:#070;">.</span><span style="color:#00b;">getStamp</span><span style="color:#070;">() &lt;&lt; </span><span style="color:#d00;">" " </span><span style="color:#070;">&lt;&lt;<br />
<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#00b;">mixin1</span><span style="color:#070;">.</span><span style="color:#00b;">getSerialNumber</span><span style="color:#070;">() &lt;&lt; </span><span style="color:#00b;">endl</span><span style="color:#070;">;<br />
<br />&nbsp;&nbsp;</span><span style="color:#00b;">cout </span><span style="color:#070;">&lt;&lt; </span><span style="color:#00b;">mixin2 </span><span style="color:#070;">&lt;&lt; </span><span style="color:#d00;">" " </span><span style="color:#070;">&lt;&lt; </span><span style="color:#00b;">mixin2</span><span style="color:#070;">.</span><span style="color:#00b;">getStamp</span><span style="color:#070;">() &lt;&lt; </span><span style="color:#d00;">" " </span><span style="color:#070;">&lt;&lt;<br />
<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#00b;">mixin2</span><span style="color:#070;">.</span><span style="color:#00b;">getSerialNumber</span><span style="color:#070;">() &lt;&lt; </span><span style="color:#00b;">endl</span><span style="color:#070;">;<br />
<br />} </p>
<p>The effect you get is basically what you get with [Ruby Mixins][5].</p>
<p> [1]: <a href="http://gplv3.fsf.org/gpl3-dd3-guide">http://gplv3.fsf.org/gpl3-dd3-guide</a><br />
 [2]: <a href="http://bjacob.livejournal.com/tag/kde+eigen">http://bjacob.livejournal.com/tag/kde+eigen</a><br />
 [3]: <a href="http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern">http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern</a><br />
 [4]: <a href="http://www.artima.com/weblogs/viewpost.jsp?thread=132988">http://www.artima.com/weblogs/viewpost.jsp?thread=132988</a><br />
 [5]: <a href="http://www.juixe.com/techknow/index.php/2006/06/15/mixins-in-ruby/">http://www.juixe.com/techknow/index.php/2006/06/15/mixins-in-ruby/</a></span></p>
