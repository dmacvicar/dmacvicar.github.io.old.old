---
layout: post
title: openSUSE 11.3 and nVidia
date: 2010-09-24 13:29:00.000000000 +02:00
type: post
published: true
status: publish
categories: []
tags:
- newsuse
- nvidia
- opensuse
- suse
meta:
  posterous_6c96d52da40a5d7e34be538822acc826_post_id: '48565110'
  posterous_6c96d52da40a5d7e34be538822acc826_permalink: http://duncan.mac-vicar.com/opensuse-113-and-nvidia
author:
  login: duncan
  email: dmacvicar@gmail.com
  display_name: duncan
  first_name: Duncan
  last_name: Mac-Vicar P.
---

<p>I was going nuts because I could not get a sane configuration for my laptop, which has a nVidia NVS 3100M card.</p>
<p>The laptop is connected most of the time to a docking station, which has a external monitor. I want to use the external monitor when the machine is on the dock, and the internal LCD when it is not. No dual head.</p>
<p>openSUSE 11.3 ships with the nouveau driver. It has wonderful RandR support. KRandTray tool detected both displays and allowed me to turn one off and the other on with 3 mouse clicks. It was not perfect, as I had to do it on dock/undock, but also at boot time.</p>
<p>Sadly, nouveau is buggy. At the beginning I was affected by a <a href="https://bugzilla.redhat.com/show_bug.cgi?id=596330">random freeze bug</a> which forced me to login from my phone to reboot the system. Deactivating acceleration made this go away, but then randomly you will see in your syslog:</p>
<div class="CodeRay">
<div class="code">
<pre>[drm] nouveau 0000:01:00.0: no space while unhiding cursor</pre>
</div>
</div>
<p>And the system will get extremely slow. Reboot needed. This was happening too often. My Linux experience completely ruined. I tried various kernels including Kernel:HEAD, but no luck. <a href="https://bugzilla.redhat.com/show_bug.cgi?id=541628">Known bug</a>, there is a report in Novell bugzilla too.</p>
<p>On the other hand, the proprietary nvidia driver seemed to work well. But KRandTray did not showed two displays. The problem is that the nVidia driver has a proprietary system to support dual head configurations.</p>
<p>You could run the nvidia-settings tool as root (!!) and change the monitor, but this was a very complicated process. My use case is: I want to hack in a different room, 2 clicks and undock.</p>
<p>Today I found googling a tip that made it work like I expected. You need to configure metamodes. Yes, I have a xorg.conf again. My Screen section looks like this:</p>
<div class="CodeRay">
<div class="code">
<pre>Section &quot;Screen&quot;
    Identifier     &quot;Screen0&quot;
    Device         &quot;Device0&quot;
    Monitor        &quot;Monitor0&quot;
    DefaultDepth    24
    SubSection     &quot;Display&quot;
        Depth       24
    EndSubSection
    Option        &quot;TwinView&quot;    &quot;1&quot;
    Option        &quot;TwinViewXineramaInfoOrder&quot;    &quot;DFP-0&quot;
    Option &quot;metamodes&quot; &quot;DFP-0: null, DFP-2: nvidia-auto-select +0+0;
               DFP-0: nvidia-auto-select +0+0, DFP-2: null&quot;
EndSection</pre>
</div>
</div>
<p>Each metamode disables one monitor. After relogin I noticed KRandTray still showed one display. But I realized I had two possible resolutions, and selecting between them switched the monitors!. Even less clicks than before, where I had to enable one and disable the other.</p>
<p>Lets see how stable it runs
<div class="p_embed p_image_embed">
<img alt="" src="{{ site.baseurl }}/assets/icon_smile.gif" />
</div>
<p> .</p>
<p>You can even bind the switching to hotkeys using xrandr calls:</p>
<div class="CodeRay">
<div class="code">
<pre>xrandr -s 0
xrandr -s 1</pre>
</div>
</div>
