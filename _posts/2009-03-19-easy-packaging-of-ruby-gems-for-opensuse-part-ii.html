---
layout: post
title: Easy packaging of ruby gems for openSUSE, part II
date: 2009-03-19 22:49:04.000000000 +01:00
type: post
published: true
status: publish
categories: []
tags:
- newsuse
- ruby
- software
- suse
meta:
  posterous_6c96d52da40a5d7e34be538822acc826_post_id: '48645379'
  posterous_6c96d52da40a5d7e34be538822acc826_permalink: http://duncan.mac-vicar.com/easy-packaging-of-ruby-gems-for-opensuse-part
  _oembed_9adb520cd72a1fb9b048ba9d78510629: "{{unknown}}"
  _oembed_d7356e846cd538e9f83a1063052de0fc: "{{unknown}}"
  _oembed_4547e2c019d9b04228b7c88b660c48d2: "{{unknown}}"
  _oembed_dd1665e4ffb592f5689efd00f3da6d15: "{{unknown}}"
  _oembed_5e2d03db144a5e47c7a8d8f01dbbaca5: "{{unknown}}"
  _oembed_37796ca9d98c39413e1a740eacda697f: "{{unknown}}"
author:
  login: duncan
  email: dmacvicar@gmail.com
  display_name: duncan
  first_name: Duncan
  last_name: Mac-Vicar P.
---
<p>
    I was in the need of learning about osc plugins, because I want to rewrite some scripts that I use to track maintenance updates to the software management stack. Learning osc plugins meant learning python at the same time.</p>
<p>I was inspired by the osc gnome todo functionality, which shows something like this:</p>
<p>    vuntz@lyon ~/work/opensuse/tmp/&gt;osc gnome todo<br />
    Downloading data in a cache. It might take a few seconds...<br />
    Package  | openSUSE:Factory | GNOME:Factory    | Upstream<br />
    ---------+------------------+------------------+-------------<br />
    anjuta   | 2.23.91          | 2.23.91          | 2.24.0.1 (r)<br />
    at-spi   | 1.23.92          | 1.23.92          | 1.24.0<br />
    gdm      | 2.23.92          | 2.23.92 (s)      | 2.24.0 (s)<br />
    gedit    | 2.23.93          | 2.23.93          | 2.24.0</p>
<p>So, in my last post, I wrote how to [easily package gems for openSUSE][1], saving at least 99% of the work. However, how do you know that you need to package a new gem? Well, here is osc ruby todo, in its first 0.0.0.0.1 release:</p>
<p>    duncan@tarro:/osc-plugins&gt; osc ruby todo<br />
    126 gems in build service projects<br />
    Retrieving upstream gem information...<br />
    + libxml-ruby upstream: 1.1.2 bs: 0.9.5<br />
    + radiant upstream: 0.7.1 bs: 0.6.9<br />
    + launchy upstream: 0.3.3 bs: 0.3.2<br />
    + hpricot upstream: 0.7 bs: 0.6.161<br />
    + net-ssh upstream: 2.0.11 bs: 2.0.8</p>
<p>So, it connects to gems.rubyforge.org and tell you which gems are outdated. Do you want to keep openSUSE a nice ruby platform? help me. The following features are waiting:</p>
<p>* track ruby package versions<br />
* track other gem repositories, like the rails one or github<br />
* also compare it with version in factory<br />
* nice tables<br />
* caching<br />
* Use [gem2rpm and the openSUSE template][1] to automatically create the specs for outdated gems</p>
<p>You can download it from [git.opensuse.org][2], just symlink the .py file to ~/.osc-plugins. It requires rpm-python and Python 2.6 or newer.</p>
<p>My ultimate goal is to get a similar one for zypp/yast that allows to compare our Head repositories with Factory and maintenance repos, show diffs and make submit requests.</p>
<p>So how does it works? How to create your own osc plugin? Look at the source code of the osc-* projects at [git.opensuse.org][3], You will realize it is as easy as:</p>
<p>* Open a .py file<br />
* Create a do_something method, adding the documentation and checking input and arguments<br />
* Use the meta_ API and urllib to get data from the build service<br />
* Use makeurl to build the right authenticated urls to do the requests.</p>
<p>[1]: <a href="http://duncan.mac-vicar.com/blog/archives/520">http://duncan.mac-vicar.com/blog/archives/520</a><br />
[2]: <a href="http://git.opensuse.org/?p=projects">http://git.opensuse.org/?p=projects</a>/osc-plugins-ruby.git;a=summary<br />
[3]: <a href="http://git.opensuse.org">http://git.opensuse.org</a></p>
