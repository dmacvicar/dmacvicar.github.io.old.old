---
layout: post
title: SUSE Manager, a year later retrospective II (Backstage)
date: 2012-05-04 10:50:03.000000000 +02:00
type: post
published: true
status: publish
categories:
- Software
tags: []
meta:
  _edit_last: '34818'
  draftfeedback_requests: a:3:{s:15:"kkaempf@suse.de";a:3:{s:3:"key";s:13:"4fa292056c1d8";s:4:"time";s:10:"1336054277";s:7:"user_id";s:5:"34818";}s:11:"joe@suse.de";a:3:{s:3:"key";s:13:"4fa292058c00b";s:4:"time";s:10:"1336054277";s:7:"user_id";s:5:"34818";}s:16:"mistinie@suse.de";a:3:{s:3:"key";s:13:"4fa29205aa21b";s:4:"time";s:10:"1336054277";s:7:"user_id";s:5:"34818";}}
  draft_feedback: "a:2:{s:15:\"kkaempf@suse.de\";a:1:{i:0;a:2:{s:4:\"time\";s:10:\"1336055174\";s:7:\"content\";s:690:\"
    \"For SUSE Manager we had the challenge of various inter-dependent components
    which makes it not trivial to test in a isolated way.\"\nWell, the challenge was
    unknown source and structure.\n\n\"We decided to test it at the user interface
    level a\" thats a necessity due to the lack of source code knowledge. Otoh, it
    matches nicely with the Agile principle of end-to-end functionality.\nAt the end
    of the day, the application behaviour is important. Not a specific API or class
    implementation.\n\n\" describing every test-case in a human-friendly way\". You
    should explicitly name \"behavior driven development\" because thats what you
    can google for ;-)\n\nSecurity: There's a line break after \"Thomas\"\n\n\";}}s:11:\"joe@suse.de\";a:1:{i:0;a:2:{s:4:\"time\";s:10:\"1336077745\";s:7:\"content\";s:283:\"
    \"and describing every test-case\": grammar, needs to say \"to [...] describe
    every [...]\"\n\nThe end comes a bit unexpectedly. Last sentence has a grammar
    problem. I'd put it a bit different. \n\n\"where possible we are trying to ...\"\n\nAnd
    maybe a short conclusion.\n\nOtherwise great stuff!\";}}}"
  _oembed_fbb373b6846f4741d1d79618a039760c: "{{unknown}}"
  _oembed_2a5b9694270eb410ebe76e8f178c3839: "{{unknown}}"
  _oembed_73355fae5734a779b940fb79f09c2231: "{{unknown}}"
  _oembed_f4d6e71b2387f514899e074d52bb3368: "{{unknown}}"
author:
  login: duncan
  email: dmacvicar@gmail.com
  display_name: duncan
  first_name: Duncan
  last_name: Mac-Vicar P.
---
<p><em><a href="http://duncan.mac-vicar.com/2012/05/03/suse-manager-a-year-later-retrospective/">I posted a retrospective</a> of what we did for our customers in <a href="http://www.suse.com/de-de/products/suse-manager/">SUSE Manager</a> during the last year. This is a continuation of that post, focusing on what is going behind the scenes.</em></p>
<h3>Testing</h3>
<p>At SUSE we love to test a lot. We sell mission-critical Linux right?. If a package .spec file manages to pass our very strict suite of checks we have enabled in the <a href="//build.opensuse.org">build service</a>, that is only the first step. We also do testing at various other levels. Our internal <a href="http://jenkins-ci.org">Jenkins instance</a> has hundreds of jobs testing the code SUSE contributes before it its packaged.</p>
<p>For SUSE Manager we had the challenge of various inter-dependent components we were at the beginning not very familiar with. We decided to test the end-user functionality and model the tests as you would do when using Behavior-Driven-Development, describing every test-case in a human-friendly way. The test-case implementation prepares some of the required environment based on the test-case descriptions.</p>
<p>One of the first things we open-sourced was <a href="https://github.com/SUSE/spacewalk-testsuite-base">this testsuite</a> we created based on <a href="http://cukes.info/">Cucumber</a>, Capybara and Selenium.</p>
<p>For every commit in our git tree we use Jenkins to send packages to the <a href="http://www.open-build-service.org">build service</a>. A few minutes later the build service not only rebuilds the changed packages but also creates the appliance images. A job takes those and deploy them on a server and a client.</p>
<p>After that the testsuite is launched and more than 200 regression and feature tests are ran against the server.</p>
<p><a href="http://duncan.files.wordpress.com/2012/05/testsuite-1.png"><img class="alignnone size-medium wp-image-1563" style="border:0 none;" title="SUSE Manager Testsuite" src="{{ site.baseurl }}/assets/testsuite-1.png?w=300" alt="" width="300" height="224" /></a></p>
<p>We also added screenshots for failed tests. If a test fails, we can see exactly where the problem was, and fix it.</p>
<p><a href="http://duncan.files.wordpress.com/2012/05/testsuite-2.png"><img src="{{ site.baseurl }}/assets/testsuite-2.png?w=300" alt="" title="SUSE Manager Testsuite II" width="300" height="255" class="alignnone size-medium wp-image-1564" style="border:0 none;" /></a></p>
<p>At the beginning, this test-suite allowed us to build an agile process by assimilating a big code-base we were not very familiar with at the beginning. Today, where we are already contributing to the upstream project, the test-suite is one of the building blocks of our continuous integration process. Allowing us to have a shippable product every night and add features with more confidence. For our customers it means enjoying SUSE Manager with the SUSE level of quality they are used to.</p>
<h3>Security</h3>
<p>SUSE products are continuously audited for security problems. <a href="http://thetoms-random-thoughts.blogspot.de/2011/06/suse-manager-security-update.html/">Thomas</a> has done a great job in the last years introducing security into the development process and educating developers about the topic. We found some problems and they were reported upstream using the standard procedures, most of the time with patches attached.</p>
<h3>Upstream</h3>
<p>You may already know that SUSE Manager is built from the <a href="http://spacewalk.redhat.com/">Spacewalk</a> project source code. When we shipped, we had done a lot of porting work which resulted on a lot of patches. It was a challenge for us at that point to become contributors to the project. Engineering and Project Management in products based on open-source components involve a lot of trade-offs between custom patches and up-streaming, between re-basing and forking. None is right. You play with them in order to satisfy your schedules, lower the overhead of custom patches (fork-debt) and adding features without sacrificing stability.</p>
<p>We are very happy with the results. We have contributed back everything that was possible and feel very welcome in the upstream community. We are very grateful to the Spacewalk developers: Miroslav Such√Ω, Jan Pazdziora, Thomas Lestach, Stephen Herr and others, who reviewed our patches and gave very insightful feedback.</p>
<p>Of course our git tree is different. There are patches that need some work in order to be up-streamed. But I think we made clear that we want to support the project. Where possible we are trying to upstream patches before we release them into our tree.</p>
<p><em>I hope I was able to give you an insight on how SUSE Manager is being developed. We have more topics to share! may be in a future post.</em></p>
