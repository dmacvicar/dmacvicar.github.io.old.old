---
layout: post
title: openSUSE as a ruby development platform
date: 2010-05-14 16:26:00.000000000 +02:00
type: post
published: true
status: publish
categories: []
tags:
- newsuse
- opensuse
- ruby
- software
- suse
meta:
  posterous_6c96d52da40a5d7e34be538822acc826_post_id: '48564984'
  posterous_6c96d52da40a5d7e34be538822acc826_permalink: http://duncan.mac-vicar.com/opensuse-as-a-ruby-development-platform
  _oembed_71e2d68dec17fe4f483348e649556810: "{{unknown}}"
  _oembed_a3c13248ff299d08d2d44866ebc11460: "{{unknown}}"
  _oembed_ba60e3881186fe791ac83b6cca73e1ed: "{{unknown}}"
  _oembed_17d499d7381fb2c8f5780e4b38eb0d38: "{{unknown}}"
author:
  login: duncan
  email: dmacvicar@gmail.com
  display_name: duncan
  first_name: Duncan
  last_name: Mac-Vicar P.
---
<br />
<h1>openSUSE is a gem for ruby development</h1>
<p>In this post I would like to show what openSUSE has to offer to ruby enthusiasts.</p>
<p>The latest openSUSE version ships with ruby 1.8.7, rubygems 1.3.1 and rails 2.3.2. The latest two being not so recent, here is where the openSUSE project shines. Say hello to <a href="http://download.opensuse.org/repositories/devel:/languages:/ruby">devel:languages:ruby</a> and <a href="http://download.opensuse.org/repositories/devel:/languages:/ruby:/extensions">devel:languages:ruby:extensions</a> build service projects.</p>
<p>The first is a project containing a more recent 1.8.7 ruby (p249 vs p72 in 11.2). However, as a build service project, it is built on top of multiple targets so you can add this repository not only to 11.2 but also to SLE and older openSUSE releases.</p>
<p>In this project you will also find a ruby19 package which is nothing else than ruby 1.9.1 p376 installable in parallel with 1.8.7.</p>
<p>The <a href="http://download.opensuse.org/repositories/devel:/languages:/ruby:/extensions">devel:languages:ruby:extensions</a> contains ruby libraries and gems. For example you can find rails 2.3.5 there. Libraries are usually packaged as ruby-something and gems are packaged as rubygem-something. Gem packages have some nice attributes:</p>
<ul>
<li>They are visible by the software management stack (rpm ZYpp, and all the ZYpp integrated tools: PackageKit, YaST, etc)</li>
<li>They are visible to the gem tool. The rpm is installed where the gem tools expects to find it</li>
<li>They are the best choice if you want distribute a fully packaged application, or an appliance using <a href="http://www.susestudio.com/">SUSE Studio</a> </li>
<li>You can easily create them from a standard gem using the gem2rpm-opensuse script included in the <a href="http://download.opensuse.org/repositories/devel:/languages:/ruby">rubygem-gem2rpm</a> package</li>
</ul>
<p>To add the gem repository to your 11.2 system, just do (as root):</p>
<div class="CodeRay">
<div class="code">
<pre>zypper ar 
http://download.opensuse.org/repositories/devel:/languages:/ruby:/extensions/openSUSE_11.2 rubygems</pre>
</div>
</div>
<h1>Living on the edge</h1>
<p>While the ruby environment provided by openSUSE is great, you may want to go one step further. What comes to my head:</p>
<ul>
<li>If you have both ruby and ruby19, you would need to have a different package for each ruby interpreter</li>
<li>Sometimes you want to try a really experimental virtual machine, however openSUSE offers no package for it (eeer, and experimental VMs make packaging difficult, especially if the developers are MacOS users whose build script download prebuilt binaries of LLVM over the internet eeeek!)</li>
<li>If you run or develop applications in the same machine, you may want to isolate the gem environment for each applications</li>
<li>You may want quickly to test a program with different interpreters.</li>
<li>You may not have root access! And sadly quacking like an administrator won&rsquo;t give you superpowers.</li>
</ul>
<h2>Enter rvm, the ruby version manager</h2>
<p>rvm is a nice tool that can quickly compile ruby interpreters from source and switch between them, all without root access (you can also set the current interpreter to the &ldquo;system&rdquo; one). Gems you install for one interpreter are isolated from the other interpreters, and you can create &ldquo;gem sets&rdquo;.</p>
<p>While rvm can be installed really easily:</p>
<div class="CodeRay">
<div class="code">
<pre>bash &lt; &lt;( curl http://rvm.beginrescueend.com/releases/rvm-install-head )</pre>
</div>
</div>
<p>for the HEAD version in github or</p>
<div class="CodeRay">
<div class="code">
<pre>bash &lt; &lt;( curl http://rvm.beginrescueend.com/releases/rvm-install-latest )</pre>
</div>
</div>
<p>You can also install it the &ldquo;openSUSE way&rdquo;, if you added the devel:languages:ruby:extensions repository:</p>
<div class="CodeRay">
<div class="code">
<pre>zypper install rubygem-rvm</pre>
</div>
</div>
<p>Once you have it installed, you will need to run rvm-install (as user) and edit your shell profile so that the environment is set correctly.</p>
<p>Then you can start using it. To see all the interpreters available in your system:</p>
<div class="CodeRay">
<div class="code">
<pre>rvm list</pre>
</div>
</div>
<p>To see all the ones known to rvm:</p>
<div class="CodeRay">
<div class="code">
<pre>rvm list --all</pre>
</div>
</div>
<p>Build 1.9 from source:</p>
<div class="CodeRay">
<div class="code">
<pre>rvm install ruby-1.9.2-head</pre>
</div>
</div>
<p>Build JRuby:</p>
<div class="CodeRay">
<div class="code">
<pre>rvm install jruby</pre>
</div>
</div>
<p>Use jruby:</p>
<div class="CodeRay">
<div class="code">
<pre>rvm use jruby</pre>
</div>
</div>
<p>Then you can &ldquo;double check&rdquo;:</p>
<div class="CodeRay">
<div class="code">
<pre>ruby -v</pre>
</div>
</div>
<p>jruby 1.4.0 (ruby 1.8.7 patchlevel 174) (2009-11-02 69fbfa3) (Java HotSpot(TM) 64-Bit Server VM 1.6.0_20) [amd64-java]</p>
<h2>Combine rvm with the powerful bundler</h2>
<p>Of all the new ruby tools, the ones I find most useful is the <a href="http://github.com/carlhuda/bundler">bundler</a>, which was created as a rails independent solution to make ruby applications specify the gems they need in their environment.</p>
<p>You can create a Gemfile in the top level directory of your application:</p>
<p>Something like.</p>
<div class="CodeRay">
<div class="code">
<pre>source 'http://gemcutter.org'
gem &quot;rails&quot;, &quot;3.0.0.beta3&quot;
gem &quot;runt&quot;, :git =&gt; &quot;http://github.com/tevio/runt.git&quot;</pre>
</div>
</div>
<p>As you can see, you can specify gems from git repositories, or use specific branches or versions. This is really nice for deployment, as you can get the working environment really easy.</p>
<div class="CodeRay">
<div class="code">
<pre>bundle install</pre>
</div>
</div>
<p>Would install the missing gems. It would reuse system gems, etc. If you are using rvm, it would install them in the interpreter specific gems.</p>
<p>The bundler has more advanced features, like the ability to take all the gems and &ldquo;bundle&rdquo; them directly &ldquo;in&rdquo; the application, but I leave that as an exercise to the reader.</p>
<h1>Conclusions</h1>
<p>So that finishes this post. I hope you could see how openSUSE looks like for a ruby developer.</p>
<p>I would like to first thanks <a href="http://news.opensuse.org/2008/03/01/people-of-opensuse-marcus-rueckert/">Marcus R&uuml;ckert (a.k.a darix)</a> as he was the main brain behind the rubygem packages. Also big thanks to the <a href="http://en.opensuse.org/YaST">YaST</a>, <a href="http://kkaempf.blogspot.com/">Klaus</a>, <a href="http://www.susestudio.com/">SUSE Studio</a> and <a href="http://build.opensuse.org/">Build Service</a> teams, whose development resulted in many package updates and contributions.</p>
